<script>
    $(function() {
        $('.editable-select').editableSelect(
                {
                    bg_iframe: true,
                    onSelect: function(list_item) {
                    },
                    case_sensitive: false, // If set to true, the user has to type in an exact
                    // match for the item to get highlighted
                    items_then_scroll: 10 // If there are more than 10 items, display a scrollbar
                }
        );
    });
  </script>

<%= form_for([@quotation, @item_detail]) do |f| %>
  <% if flash[:notice] %>
    <div id="notice"><i>* <%= flash[:notice] %></i></div> <br>
  <% end %>

  <% if @item_detail.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@item_detail.errors.count, "error") %> prohibited this item_detail from being saved:</h2>

      <ul>
        <% @item_detail.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :particulars %>
    <br>
    <% item_array = ItemDetail.all.sort_by{|u| u.particulars.downcase}.uniq{|d| d[:particulars]}.map { |i| [i.id, i.particulars] } %>
    <%= f.select :particulars, options_for_select(item_array, @item_detail.particulars), { :include_blank=>true }, { :class => 'editable-select'}%>


  </div>
  <div class="field">
    <%= f.label :quantity %>
    <br>
    <%= f.text_field :quantity %>
  </div>
  <div class="field">
    <%= f.label :days %>
    <br>
    <%= f.text_field :days %>
  </div>
  <div class="field">
    <%= f.label :unit_price %>
    <br>
    <%= f.text_field :unit_price %>
  </div>
  <div class="field">
    <%= f.label :vendor_id, 'Vendor' %>
    <br>
    <% clients_array = Client.all.map { |client| [client.company_name, client.id] } %>
    <%= f.select(:vendor_id, options_for_select(clients_array, @item_detail.vendor_id.nil? ? 0 : @item_detail.vendor_id), { :include_blank => true }, prompt: 'Select Vendor') %>
  </div>
  <div class="field">
    <%= f.label :vendor_quantity, 'Vendor Quantity' %>
    <br>
    <%= f.text_field :vendor_quantity %>
  </div>
  <div class="field">
    <%= f.label :vendor_price, 'Vendor Price' %>
    <br>
    <%= f.text_field :vendor_price %>
  </div>
  <div class="actions">

    <%= f.submit %>
    <%= link_to 'Back To Quotation', quotation_item_details_path(@quotation.id) %>

  </div>
<% end %>
